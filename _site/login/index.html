<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Login â€¢ Investor Anatomy</title>
  <script defer src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
</head>
<body>
  <h1>Sign in</h1>
  <p>Please sign in to continue.</p>
  <button id="loginBtn">Sign in</button>

  <script>
    // Requested path is encoded into /login/<path>
    function requestedPathFromLoginUrl() {
      // examples:
      // /login/signal_report/abc  -> /signal_report/abc
      // /login/                   -> /
      const path = window.location.pathname || "/";
      const prefix = "/login";
      if (path === prefix || path === prefix + "/") return "/";
      if (path.startsWith(prefix + "/")) return "/" + path.slice((prefix + "/").length);
      return "/";
    }

    function goBack() {
      window.location.href = requestedPathFromLoginUrl();
    }

    document.getElementById("loginBtn").addEventListener("click", () => {
      netlifyIdentity.open("login");
    });

    netlifyIdentity.on("init", user => {
      if (user) goBack();
    });

    netlifyIdentity.on("login", user => {
      netlifyIdentity.close();
      goBack();
    });

    netlifyIdentity.init();
  </script>
</body>
</html>
